<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <script>
      const userMode = localStorage.getItem('vuepress-reco-color-scheme');
      const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

      if (userMode === 'dark' || (typeof userMode !== 'string' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true);
      }
    </script>
    <link rel="shortcut icon" href="/Notebook/logo.png"><title>Webpack5.0 学习笔记 | KurumiW's Notebook</title><meta name="description" content="">
    <link rel="preload" href="/Notebook/assets/js/runtime~app.4db732ba.js" as="script"><link rel="preload" href="/Notebook/assets/css/styles.6d5b7344.css" as="style"><link rel="preload" href="/Notebook/assets/js/776.3dff3c17.js" as="script"><link rel="preload" href="/Notebook/assets/js/app.c00fca95.js" as="script">
    <link rel="stylesheet" href="/Notebook/assets/css/styles.6d5b7344.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><div class="common-wrapper no-sidebar show-page-headers"><header class="navbar-container"><div class="toggle-sidebar-button" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span class="site-brand"><a href="/Notebook/" class=""><img class="logo" src="/Notebook/logo.png" alt="KurumiW&#39;s Notebook"><span class="site-name can-hide">KurumiW&#39;s Notebook</span></a></span><div class="navbar-links-wrapper" style=""><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/Notebook/" class="nav-link" aria-label="首页"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->首页<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/Notebook/categories/Frontend/1/" class="nav-link" aria-label="分类"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/Notebook/tags/JavaScript/1/" class="nav-link" aria-label="标签"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->标签<!--]--></span></a><!--[--><!--]--></a></div><!--]--></nav><a class="icon-container left btn-toggle-dark-mode" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:20px;height:20px;font-size:20px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"></path><path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0-2 2a2 2 0 0 0-2-2a2 2 0 0 0 2-2"></path><path d="M19 11h2m-1-1v2"></path></g></svg><!----></a></div></header><div class="sidebar-mask"></div><aside class="series-container"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/Notebook/" class="nav-link" aria-label="首页"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->首页<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/Notebook/categories/Frontend/1/" class="nav-link" aria-label="分类"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/Notebook/tags/JavaScript/1/" class="nav-link" aria-label="标签"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->标签<!--]--></span></a><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--></aside><!--[--><main class="page-container show-page-headers"><h1 class="page-title">Webpack5.0 学习笔记</h1><div class="page-info"><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="7" r="4"></circle><path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[-->KurumiW<!--]--></span></a><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 7v5l3 3"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[-->2021-01-01 00:00:00<!--]--></span></a><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg><span style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/Notebook/categories/Frontend/1/" class="category">Frontend</a><!--]--><!--]--></span></a><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="1" fill="currentColor"></circle><path d="M4 7v3.859c0 .537.213 1.052.593 1.432l8.116 8.116a2.025 2.025 0 0 0 2.864 0l4.834-4.834a2.025 2.025 0 0 0 0-2.864L12.29 4.593A2.025 2.025 0 0 0 10.859 4H7a3 3 0 0 0-3 3z"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/Notebook/tags/JavaScript/1/" class="tag">JavaScript</a><a href="/Notebook/tags/Webpack/1/" class="tag">Webpack</a><!--]--><!--]--></span></a><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="2"></circle><path d="M22 12c-2.667 4.667-6 7-10 7s-7.333-2.333-10-7c2.667-4.667 6-7 10-7s7.333 2.333 10 7"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[--><span id="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html" class="leancloud-visitors" data-flag-title="Your Article Title"><a class="leancloud-visitors-count" style=""></a></span><!--]--></span></a></div><div class="theme-reco-default-content"><!--[--><h1 id="webpack" tabindex="-1"><a class="header-anchor" href="#webpack" aria-hidden="true">#</a> Webpack</h1><h2 id="一、简介" tabindex="-1"><a class="header-anchor" href="#一、简介" aria-hidden="true">#</a> 一、简介</h2><blockquote><p>Webpack 是一个前端资源构建工具，静态模块打包器(module bundler)。它根据模块的依赖关系，经过打包生成对应的静态资源</p></blockquote><h3 id="_1-打包流程" tabindex="-1"><a class="header-anchor" href="#_1-打包流程" aria-hidden="true">#</a> 1.打包流程</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>index.js
| jQuery less ... (静态模块)
| chunk(代码块)
| | [less-&gt;css][js-&gt;浏览器可编译的js]
| | 打包
| | bundle
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-五个核心" tabindex="-1"><a class="header-anchor" href="#_2-五个核心" aria-hidden="true">#</a> 2.五个核心</h3><h4 id="_2-1-entry" tabindex="-1"><a class="header-anchor" href="#_2-1-entry" aria-hidden="true">#</a> 2.1 Entry</h4><p>入口：指示 Webpack 以哪个文件为入口进行打包，并分析其内部依赖关系</p><h4 id="_2-2-output" tabindex="-1"><a class="header-anchor" href="#_2-2-output" aria-hidden="true">#</a> 2.2 Output</h4><p>输出：指示 Webpack 打包后的 bundle 输出到哪个目录下，以及包名</p><h4 id="_2-3-loader" tabindex="-1"><a class="header-anchor" href="#_2-3-loader" aria-hidden="true">#</a> 2.3 Loader</h4><p>加载器：让 Webpack 处理非 js 文件（Webpack 本身只能处理 js 文件）</p><h4 id="_2-4-plugins" tabindex="-1"><a class="header-anchor" href="#_2-4-plugins" aria-hidden="true">#</a> 2.4 Plugins</h4><p>插件：比 Loader 执行的范围更广泛，插件的范围包括：从打包优化和压缩，一直到重新定义环境中的变量。</p><h4 id="_2-5-mode" tabindex="-1"><a class="header-anchor" href="#_2-5-mode" aria-hidden="true">#</a> 2.5 Mode</h4><p>模式：指示 Webpack 使用对应的模式进行配置</p><table><thead><tr><th>模式</th><th>描述</th><th>特点</th></tr></thead><tbody><tr><td>development 开发模式</td><td>会将 <code>process.env.NODE_ENV</code> 的值设为 <code>development</code>。启用 <code>NamedChunksPlugin</code> 和 <code>NamedModulesPlugin</code>。</td><td>可以让代码进行本地调试的环境</td></tr><tr><td>production 生产模式</td><td>会将 <code>process.env.NODE_ENV</code> 的值设为 <code>production</code>。启用<code> FlagDependencyUsagePlugin</code>, <code>FlagIncludedChunksPlugin</code>, <code>ModuleConcatenationPlugin</code>, <code>NoEmitOnErrorsPlugin</code>, <code>OccurrenceOrderPlugin</code>, <code>SideEffectsFlagPlugin</code> 和 <code>UglifyJsPlugin</code>.</td><td>可以让代码优化上线的环境</td></tr></tbody></table><h2 id="二、初次使用" tabindex="-1"><a class="header-anchor" href="#二、初次使用" aria-hidden="true">#</a> 二、初次使用</h2><h3 id="_1-index-js" tabindex="-1"><a class="header-anchor" href="#_1-index-js" aria-hidden="true">#</a> 1.index.js</h3><blockquote><p>入口起点文件</p></blockquote><h4 id="_1-1-运行指令" tabindex="-1"><a class="header-anchor" href="#_1-1-运行指令" aria-hidden="true">#</a> 1.1 运行指令</h4><ul><li>开发环境</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>webpack ./src/index.js -o ./build/built.js --mode<span class="token operator">=</span>development
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>流程：<code>Webpack</code>以<code>./src/index.js</code>为入口进行打包，输出到<code>./build/built.js</code>。打包模式为开发环境</p><ul><li>生产环境</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>webpack ./src/index.js -o ./build/built_product.js --mode<span class="token operator">=</span>production
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>流程：<code>Webpack</code>以<code>./src/index.js</code>为入口进行打包，输出到<code>./build/built_product.js</code>。打包模式为生产环境，生产环境会压缩 js 代码</p><h4 id="_1-2-结论" tabindex="-1"><a class="header-anchor" href="#_1-2-结论" aria-hidden="true">#</a> 1.2 结论</h4><p>1.<code>webpack</code>可以处理<code>js/json</code>资源，不能处理<code>css/img</code>等资源 2.生产环境将 ES6 模块化编译成浏览器可识别的模块化 3.生产环境压缩了 js 代码</p><h2 id="三、打包-html-资源" tabindex="-1"><a class="header-anchor" href="#三、打包-html-资源" aria-hidden="true">#</a> 三、打包 HTML 资源</h2><ul><li>Loader: 下载 -&gt; 配置</li><li>Plugins: 下载 -&gt; 引入 -&gt; 配置</li></ul><blockquote><p>webpack.config.js</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 引入</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 入口html</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;app.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 出口html</span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 在指定标签中生成script标签</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p>html-webpack-plugin</p></blockquote><p>默认创建一个空的 HTML，自动引入打包输出的所有资源 如果需要指定某个有结构的 HTML 文件：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 复制该文件，并自动引入打包输出的所有资源</span>
  <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.html&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="四、开发环境配置" tabindex="-1"><a class="header-anchor" href="#四、开发环境配置" aria-hidden="true">#</a> 四、开发环境配置</h2><h3 id="_1-使用-source-map" tabindex="-1"><a class="header-anchor" href="#_1-使用-source-map" aria-hidden="true">#</a> 1.使用 source map</h3><blockquote><p>webpack.config.js</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;inline-source-map&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>配置<code>inline-source-map</code>后，浏览器可以查找到原本的 <code>js</code> 文件代码，而非<code>webpack</code>打包后的代码</p><h3 id="_2-使用-watch-mode" tabindex="-1"><a class="header-anchor" href="#_2-使用-watch-mode" aria-hidden="true">#</a> 2.使用 watch mode</h3><p>打包时使用命令：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>webpack --watch
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>开启 watch mode，使 webpack 能够监听代码的修改从而自动进行响应式的打包操作</p><h3 id="_3-使用-webpack-dev-server" tabindex="-1"><a class="header-anchor" href="#_3-使用-webpack-dev-server" aria-hidden="true">#</a> 3.使用 webpack-dev-server</h3><p>安装 <code>webpack-dev-server</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i webpack-dev-server -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用<code>webpack-dev-server</code>启动项目</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>npx webpack-dev-server
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用<code>webpack-dev-server</code>能够实现项目代码实时更新，提高开发效率与<code>webpack</code>的编译效率</p><h2 id="五、资源模块" tabindex="-1"><a class="header-anchor" href="#五、资源模块" aria-hidden="true">#</a> 五、资源模块</h2><h3 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1.简介</h3><p>资源模块<code>asset module</code></p><p>资源模块允许<code>webpack</code>打包其他类型的资源文件</p><p>资源模块类型<code>asset module type</code>通过四种新的类型模块替换所有的<code>loader</code></p><p>四种类型：</p><ol><li><code>asset/resource</code> 发送一个单独的文件并导出<code>URL</code></li><li><code>asset/inline</code>导出资源的<code>uri</code></li><li><code>asset/source</code>导出资源的源代码</li><li><code>asset</code>会在导出单独文件或导出<code>uri</code>之间自动进行选择</li></ol><h3 id="_2-resource-资源" tabindex="-1"><a class="header-anchor" href="#_2-resource-资源" aria-hidden="true">#</a> 2.resource 资源</h3><p>打包<code>png</code>类型资源</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="指定资源输出目录及文件名" tabindex="-1"><a class="header-anchor" href="#指定资源输出目录及文件名" aria-hidden="true">#</a> 指定资源输出目录及文件名</h4><ol><li>在<code>output</code>中定义</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span> <span class="token string">&quot;image/test.png&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 输出至打包路径下的image目录中，命名为test.png</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span> <span class="token string">&quot;image/[contenthash][ext]&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 输出至打包路径下的image目录中，命名为webpack自动生成的hash，后缀为原文件后缀</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>在<code>generator</code>中定义</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;images/[contenthash][ext]&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>对于相同的配置，如同时在<code>generator</code>和<code>output</code>中定义图片输出路径，将以后面定义的为准</strong></p><h3 id="_3-inline-资源" tabindex="-1"><a class="header-anchor" href="#_3-inline-资源" aria-hidden="true">#</a> 3.inline 资源</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset/inline&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>使用<code>inline</code>打包的图像文件不会出现在<code>dist</code>目录下</p><p>文件会以<code>base64</code>的形式直接添加在<code>html</code>文件中</p><h3 id="_4-source-资源" tabindex="-1"><a class="header-anchor" href="#_4-source-资源" aria-hidden="true">#</a> 4.source 资源</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset/source&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>可以直接将<code>txt</code>文件中的文字（源代码）添加到<code>html</code>容器中</p><h3 id="_5-asset-自动解析" tabindex="-1"><a class="header-anchor" href="#_5-asset-自动解析" aria-hidden="true">#</a> 5.asset 自动解析</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 文件大于4M生成资源，否则生成base64</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="六、loader" tabindex="-1"><a class="header-anchor" href="#六、loader" aria-hidden="true">#</a> 六、Loader</h2><h3 id="_1-加载样式文件" tabindex="-1"><a class="header-anchor" href="#_1-加载样式文件" aria-hidden="true">#</a> 1.加载样式文件</h3><h4 id="_1-1-加载原生-css" tabindex="-1"><a class="header-anchor" href="#_1-1-加载原生-css" aria-hidden="true">#</a> 1.1 加载原生 CSS</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 先使用css-loader识别css文件，再使用style-loader将样式放入文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>webpack</code>不能直接打包样式文件，引入<code>css</code>样式后，如要使用<code>loader</code>用来加载样式文件</p><p>加载<code>css</code>，需要使用<code>style-loader</code>与<code>css-loader</code></p><p><code>use</code>数组中的<code>loader</code>会按照<strong>从后向前的顺序</strong>加载：<strong>链式逆序加载</strong></p><h4 id="_1-2-加载预处理器" tabindex="-1"><a class="header-anchor" href="#_1-2-加载预处理器" aria-hidden="true">#</a> 1.2 加载预处理器</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|scss)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 先使用sass-loader将sass转换成css，然后使用css-loader识别css文件，再使用style-loader将样式放入文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-抽离和压缩样式文件" tabindex="-1"><a class="header-anchor" href="#_2-抽离和压缩样式文件" aria-hidden="true">#</a> 2.抽离和压缩样式文件</h3><h4 id="_2-1-抽离样式" tabindex="-1"><a class="header-anchor" href="#_2-1-抽离样式" aria-hidden="true">#</a> 2.1 抽离样式</h4><blockquote><p>安装插件 mini-css-extract-plugin</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i mini-css-extract-plugin -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;styles/[contenthash].css&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|scss)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>将原本的<code>style-loader</code>替换成了<code>mini-css-extract-plugin</code>插件的<code>loader</code></p><p>执行打包命令后，在输出目录下生成了一个<code>css</code>文件，，并且引入到了目标<code>html</code>文件中</p><h4 id="_2-2-压缩样式" tabindex="-1"><a class="header-anchor" href="#_2-2-压缩样式" aria-hidden="true">#</a> 2.2 压缩样式</h4><blockquote><p>安装插件 css-minimizer-webpack-plugin</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i css-minimizer-webpack-plugin -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;css-minimizer-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 打包模式需为production</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 在优化配置中加载该插件，而不是plugins中</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>执行打包命令后，输出目录下生成了压缩后的样式文件</p><h3 id="_3-加载字体文件" tabindex="-1"><a class="header-anchor" href="#_3-加载字体文件" aria-hidden="true">#</a> 3.加载字体文件</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>asset/resource</code>可以加载任何类型的资源</p><h3 id="_4-加载数据" tabindex="-1"><a class="header-anchor" href="#_4-加载数据" aria-hidden="true">#</a> 4.加载数据</h3><ul><li><p>JSON：Nodejs 本身支持，可直接加载；</p></li><li><p>XML：安装 <code>xml-loader</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i xml-loader -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>加载后，转化为 js 对象形式；</p></li><li><p>CSV/TSV：安装<code>csv-loader</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i csv-loader -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>加载后，转为数组形式。</p></li><li><p>toml/yaml/json5: 安装<code>toml</code> <code>yaml</code> <code>json5</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i toml yaml json5 -D
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;toml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.toml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">parse</span><span class="token operator">:</span> toml<span class="token punctuation">.</span>parse<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 其余同理</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul><h2 id="七、babel-loader" tabindex="-1"><a class="header-anchor" href="#七、babel-loader" aria-hidden="true">#</a> 七、Babel loader</h2><h3 id="_1-用途" tabindex="-1"><a class="header-anchor" href="#_1-用途" aria-hidden="true">#</a> 1.用途</h3><p>在开发过程中，一定会用到 ES6 语法，而当<code>webpack</code>对项目进行打包时，ES6 相关代码会原封不动地输出，如果浏览器不支持 ES6 语法，则会出现错误。</p><p>这时便需要使用到<code>babel-loader</code>，将<code>babel</code>和<code>webpack</code>进行结合</p><h3 id="_2-使用" tabindex="-1"><a class="header-anchor" href="#_2-使用" aria-hidden="true">#</a> 2.使用</h3><p>安装：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -D babel-loader @babel/core @babel/preset-env
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong>babel-loader</strong>:在<code>webpack</code>中应用<code>babel</code>解析<code>ES6</code>的桥梁</li><li><strong>@babel/core</strong>:babel 核心模块</li><li><strong>@babel/preset-env</strong>:babel 预设，一组 babel 插件的集合</li></ul><p>配置：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 对除了nodemodules以外的代码进行编译</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_3-error-regeneratorruntime-is-not-defined" tabindex="-1"><a class="header-anchor" href="#_3-error-regeneratorruntime-is-not-defined" aria-hidden="true">#</a> 3. Error : regeneratorRuntime is not defined</h3><p><code>regeneratorRuntime </code>用于在 babel 编译中兼容<code>async/await</code></p><p>需要额外添加两个库</p><ul><li><strong>@babel/runtime</strong> 包含了 <code>regeneratorRuntime </code> 运行时需要的内容</li><li><strong>@babel/plugin-transform-runtime</strong> 在需要<code>regeneratorRuntime </code>的地方自动<code>require</code>导包</li></ul><p>配置</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 对除了nodemodules以外的代码进行编译</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 添加这个插件</span>
        <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="八、代码分离" tabindex="-1"><a class="header-anchor" href="#八、代码分离" aria-hidden="true">#</a> 八、代码分离</h2><p>把多个模块共享的代码分离出去，减少入口文件大小，提高首屏加载速度</p><p>常见的代码分离方法:</p><ul><li><strong>入口起点</strong>：使用<code>entry</code>配置，手动的分离代码；</li><li><strong>防止重复</strong>：使用 <code>Entry dependencies</code> 或者<code>SplitChunkPlugin</code>去重和分离代码；</li><li><strong>动态导入</strong>：通过模块内联函数调用分离代码</li></ul><h3 id="_1-入口起点" tabindex="-1"><a class="header-anchor" href="#_1-入口起点" aria-hidden="true">#</a> 1.入口起点</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 多入口</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">another</span><span class="token operator">:</span> <span class="token string">&quot;./src/another.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 按照entry中的key命名</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].bundle.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;build&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>打包后的目录：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>another.bundle.js
index.bundle.js
index.html
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>缺点</strong>：如果两个入口都对某个包进行引入（公共模块，如<code>lodash</code>等），那么导出的每个<code>chunk</code>都会对引用的包进行导入，造成代码冗余</p><h3 id="_2-防止重复" tabindex="-1"><a class="header-anchor" href="#_2-防止重复" aria-hidden="true">#</a> 2.防止重复</h3><p>针对代码冗余，修改后的配置：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">dependOn</span><span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">another</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/another.js&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">dependOn</span><span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>含义</strong>：如果<code>index</code>与<code>another</code>都含有<code>lodash</code>模块的话，将其抽离出来，创建名为<code>shared</code>的<code>chunk</code></p><p>打包后的目录：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>another.bundle.js
index.bundle.js
index.html
shared.bundle.js
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>使用 webpack 内置插件：split-chunks-plugin</strong></p><p>可以自动抽离公共代码</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">another</span><span class="token operator">:</span> <span class="token string">&quot;./src/another.js&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-动态导入" tabindex="-1"><a class="header-anchor" href="#_3-动态导入" aria-hidden="true">#</a> 3.动态导入</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> element<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>利用<code>import</code>函数进行动态导入模块，打包后，模块会被拆分为一个单独的<code>chunk</code></p><p><strong>动态-静态混合导入</strong></p><p>需要在配置中添加</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-懒加载" tabindex="-1"><a class="header-anchor" href="#_4-懒加载" aria-hidden="true">#</a> 4.懒加载</h3><p>利用<code>import</code>方法实现<code>js</code>文件的懒加载</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&quot;加法&quot;</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 魔法注释 用于更改导出后包的命名</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/*webpackChunkName:&quot;math&quot;*/</span> <span class="token string">&quot;./math.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在开发者工具中<code>Network</code>可以看到，点击按钮前，并未调用<code>math.js</code>文件，点击按钮调用<code>add</code>方法时，才调用了该文件，实现了懒加载</p><h3 id="_5-预获取-预加载模块" tabindex="-1"><a class="header-anchor" href="#_5-预获取-预加载模块" aria-hidden="true">#</a> 5.预获取/预加载模块</h3><p>声明<code>import</code>时，使用以下内置指令，让<code>webpack</code>输出“<code>resource hint</code>资源提示”，告知浏览器：</p><ul><li><strong>prefetch</strong> 预获取：将来某些导航下可能需要的资源</li><li><strong>preload</strong> 预加载：当前导航下可能需要的资源</li></ul><h4 id="_5-1-prefetch" tabindex="-1"><a class="header-anchor" href="#_5-1-prefetch" aria-hidden="true">#</a> 5.1 prefetch</h4><p>在<code>import</code>时，添加注释</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true* / &quot;./math.js&quot;).then(()=&gt;{})
</span></code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>打包后，页面头部标签里会加入一个<code>link</code>元素，预获取了打包后的<code>math.js</code></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefetch<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://127.0.0.1:5500/8.%E4%BB%A3%E7%A0%81%E5%88%86%E7%A6%BB/build/math.bundle.js<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>效果：在页面内容加载完毕，网络空闲时，加载<code>math.bundle.js</code></p><h4 id="_5-2-preload" tabindex="-1"><a class="header-anchor" href="#_5-2-preload" aria-hidden="true">#</a> 5.2 preload</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*webpackPreload: true*/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>效果类似懒加载。</p><p><strong>最优方案：使用 prefetch 预获取</strong></p><h2 id="九、缓存" tabindex="-1"><a class="header-anchor" href="#九、缓存" aria-hidden="true">#</a> 九、缓存</h2><p>每次访问网站，浏览器获取服务器上的前端资源都会消耗时间，所以浏览器通常会自带缓存技术，利用缓存，降低网络请求流量，以使网站加载速度更快。</p><p>但是，浏览器缓存是<strong>通过文件名判断</strong>，发包后文件名没有更改，浏览器会使用已缓存的版本渲染，对用户和开发都不够友好。</p><h3 id="_1-输出文件名" tabindex="-1"><a class="header-anchor" href="#_1-输出文件名" aria-hidden="true">#</a> 1.输出文件名</h3><p>利用<code>contenthash</code>:根据文件内容生成<code>hash</code>来修改文件名</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].[contenthash].js&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-缓存第三方库" tabindex="-1"><a class="header-anchor" href="#_2-缓存第三方库" aria-hidden="true">#</a> 2.缓存第三方库</h3><p>一般采取将第三方库提取到单独的<code>vendor chunk</code>文件中的方法。</p><p>第三方库很少像本地代码一样频繁修改，通过以上步骤，利用<code>client</code>长效缓存机制，命中缓存从而消除请求，减少向服务器获取资源的同时，还能保证客户端、服务端代码版本一致。</p><p>简单来说，就是将第三方代码单独缓存到浏览器，只有本地代码更新时，浏览器缓存才会更新，而第三方库始终可以使用浏览器缓存的。</p><p>将<code>node_modules</code>路径下所有的库打包进<code>vendors.js</code>中：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">vendor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;vendors&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="十、拆分环境配置" tabindex="-1"><a class="header-anchor" href="#十、拆分环境配置" aria-hidden="true">#</a> 十、拆分环境配置</h2><h3 id="_1-公共路径" tabindex="-1"><a class="header-anchor" href="#_1-公共路径" aria-hidden="true">#</a> 1.公共路径</h3><p>服务器静态资源存放路径：影响打包后的<code>index.html</code>文件中路径的引入（默认使用相对路径引入）</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-环境变量" tabindex="-1"><a class="header-anchor" href="#_2-环境变量" aria-hidden="true">#</a> 2.环境变量</h3><p>配置中的<code>module.exports</code>可以定义为函数，有默认的参数，参数为当前的环境变量</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// 各种webpack配置</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在输入命令行进行打包时，用户可以自己输入环境变量</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>npx webpack --env production --env <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;apple&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>此时，打印函数中的<code>env</code>可以得到</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token constant">WEBPACK_BUNDLE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token constant">WEBPACK_BUILD</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">production</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;apple&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>根据用户输入的环境变量，对配置做出相应的改变，如打包模式</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">mode</span><span class="token operator">:</span> env<span class="token punctuation">.</span>production <span class="token operator">?</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意：此时生产环境打包后，js 代码并没有被折叠，是因为引入了 CssMinimizerPlugin。需要再引入一个 js 的 minimizer 插件：terser-webpack-plugin 并进行实例化</p></blockquote><h3 id="_3-拆分配置文件" tabindex="-1"><a class="header-anchor" href="#_3-拆分配置文件" aria-hidden="true">#</a> 3.拆分配置文件</h3><p>如果所有环境都在同一个配置文件中，就只能通过 2 中的方法，使用逻辑判断语句，判断环境变量达到修改配置的目的，如果各环境打包方式区别很大，这样的方法管理起来会十分棘手，就需要针对各环境，对配置文件进行拆分。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><a class="icon-container left meta-item-label" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:20px;height:20px;font-size:20px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.795 21H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4"></path><circle cx="18" cy="18" r="4"></circle><path d="M15 3v4"></path><path d="M7 3v4"></path><path d="M3 11h16"></path><path d="M18 16.496V18l1 1"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[-->Last Updated 2022-10-18 01:16:35<!--]--></span></a></div></footer><!----><div class="reco-valine-wrapper" style="display:block;"><div id="valine"></div></div></main><!--]--><div class="page-header-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#一、简介" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="一、简介"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->一、简介<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-打包流程" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.打包流程"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.打包流程<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-五个核心" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.五个核心"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.五个核心<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#二、初次使用" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="二、初次使用"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->二、初次使用<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-index-js" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.index.js"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.index.js<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#三、打包-html-资源" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="三、打包 HTML 资源"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->三、打包 HTML 资源<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#四、开发环境配置" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="四、开发环境配置"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->四、开发环境配置<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-使用-source-map" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.使用 source map"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.使用 source map<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-使用-watch-mode" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.使用 watch mode"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.使用 watch mode<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-使用-webpack-dev-server" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3.使用 webpack-dev-server"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3.使用 webpack-dev-server<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#五、资源模块" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="五、资源模块"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->五、资源模块<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-简介" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.简介"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.简介<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-resource-资源" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.resource 资源"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.resource 资源<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-inline-资源" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3.inline 资源"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3.inline 资源<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_4-source-资源" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="4.source 资源"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->4.source 资源<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_5-asset-自动解析" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="5.asset 自动解析"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->5.asset 自动解析<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#六、loader" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="六、Loader"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->六、Loader<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-加载样式文件" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.加载样式文件"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.加载样式文件<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-抽离和压缩样式文件" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.抽离和压缩样式文件"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.抽离和压缩样式文件<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-加载字体文件" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3.加载字体文件"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3.加载字体文件<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_4-加载数据" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="4.加载数据"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->4.加载数据<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#七、babel-loader" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="七、Babel loader"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->七、Babel loader<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-用途" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.用途"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.用途<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-使用" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.使用"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.使用<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-error-regeneratorruntime-is-not-defined" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3. Error : regeneratorRuntime is not defined"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3. Error : regeneratorRuntime is not defined<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#八、代码分离" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="八、代码分离"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->八、代码分离<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-入口起点" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.入口起点"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.入口起点<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-防止重复" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.防止重复"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.防止重复<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-动态导入" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3.动态导入"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3.动态导入<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_4-懒加载" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="4.懒加载"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->4.懒加载<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_5-预获取-预加载模块" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="5.预获取/预加载模块"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->5.预获取/预加载模块<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#九、缓存" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="九、缓存"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->九、缓存<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-输出文件名" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.输出文件名"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.输出文件名<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-缓存第三方库" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.缓存第三方库"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.缓存第三方库<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-header-menu-depth_2"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#十、拆分环境配置" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="十、拆分环境配置"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->十、拆分环境配置<!--]--></span></a><!--[--><!--]--></a></li><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_1-公共路径" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="1.公共路径"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->1.公共路径<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_2-环境变量" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="2.环境变量"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->2.环境变量<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-header-menu-depth_3"><a aria-current="page" href="/Notebook/blogs/Frontend/2021-01-01-webpack_study.html#_3-拆分配置文件" class="router-link-active router-link-exact-active nav-link page-header-item" aria-label="3.拆分配置文件"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->3.拆分配置文件<!--]--></span></a><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></div></div><!----><!----><!--]--></div>
    <script src="/Notebook/assets/js/runtime~app.4db732ba.js" defer></script><script src="/Notebook/assets/js/776.3dff3c17.js" defer></script><script src="/Notebook/assets/js/app.c00fca95.js" defer></script>
  </body>
</html>
